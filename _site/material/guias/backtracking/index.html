<!DOCTYPE html>
<html lang="es">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Backtracking</title>
  <meta name="description" content="Página de la materia Algoritmos y Programación II, curso Buchwald. Facultad de Ingeniería, Universidad de Buenos Aires.">

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        crossorigin="anonymous" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
  <link rel="stylesheet" href="/algo2/assets/main.css" type="text/css" />
  <link rel="shortcut icon" href="/algo2/assets/img/favicon.ico" type="image/x-icon">
  <!-- <link rel="canonical" href="http://localhost:4000/algo2/material/guias/backtracking/"> -->

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
        crossorigin="anonymous" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
          crossorigin="anonymous" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
          crossorigin="anonymous" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa"
          onload="renderMathInElement(document.body);"></script>
  
</head>


  <body>
    <header role="banner" class="sticky-top container-fluid px-1">
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand d-lg-none" href="#">Algoritmos y Programación II</a>
    <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#sitenav"
            aria-controls="sitenav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="sitenav">
      <ul class="navbar-nav mr-auto mt-2 mt-lg-0 small mx-auto">
        <li class="nav-item "><a class="nav-link" href="/algo2/"><span class="fa fa-home"></span> Inicio</a></li>
        <li class="nav-item "><a class="nav-link" href="/algo2/docentes/"><span class="fa fa-chalkboard-teacher"></span> Docentes</a></li>
        <li class="nav-item "><a class="nav-link" href="/algo2/regimen/"><span class="fa fa-tasks"></span> Régimen</a></li>
        <li class="nav-item "><a class="nav-link" href="/algo2/calendario/"><span class="fa fa-calendar-alt"></span> Calendario</a></li>
        <li class="nav-item "><a class="nav-link" href="/algo2/tps/"><span class="fa fa-briefcase"></span> TPs</a></li>
        
        <li class="nav-item dropdown ">
          <a class="nav-link dropdown-toggle" href="#" role="button" id="matDropdown"
                                              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="fa fa-paperclip"></span> Material</a>
          <ul class="dropdown-menu">
            <li class=""><a class="dropdown-item" href="/algo2/bibliografia/"><span class="fa fa-book"></span> Bibliografía</a></li>
            <li class=""><a class="dropdown-item" href="/algo2/material/"><span class="fa fa-book-reader"></span> Apuntes del curso</a></li>
            <li class=""><a class="dropdown-item" href="/algo2/material/guias/"><span class="fa fa-dumbbell"></span> Guías de ejercicios</a></li>
            <li>
              <a class="dropdown-item" href="https://drive.google.com/drive/folders/0B0x0VPz_v-f_ekhhQUpkay13RnM?resourcekey=0-BqMLnLNd6T8lRDzv-VL4xA&usp=sharing" target="_blank"><span class="fab fa-google-drive"></span> Drive</a>
            </li>
            <li>
              <a class="dropdown-item" href="https://www.youtube.com/channel/UCnmq-CGB2lEiwxhpa_Q63qQ" target="_blank"><span class="fab fa-youtube"></span> Canal</a>
            </li>
            <li><a class="dropdown-item" href="/algo2/faq/"><span class="fas fa-question-circle"></span> FAQ</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" id="aluDropdown"
                                              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="fa fa-user-friends"></span> Alumno</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="https://algoritmos-rw.github.io/algo2_skel"><span class="fa fa-file-download"></span> Descargas</a></li>
            <li><a class="dropdown-item" href="https://algoritmos-rw.dijkstra.ar/entregas/"><span class="fa fa-file-upload"></span> Entregas</a></li>
            <li><a class="dropdown-item" href="https://algoritmos-rw.dijkstra.ar/notas/"><span class="fa fa-pencil-alt"></span> Notas</a></li>
          </ul>
        </li>
        <li class="nav-item "><a class="nav-link" href="/algo2/encuestas/"><span class="fa fa-poll"></span> Encuestas</a></li>
        <li class="nav-item "><a class="nav-link" href="/algo2/infraestructura/"><span class="fa fa-network-wired"></span> Infraestructura</a></li>
        <li class="nav-item">
          <a href="https://github.com/algoritmos-rw/algo2/blob/master/material/guias/backtracking.md" class="nav-link" target="_blank"><span class="fab fa-github"></span> Editar en GitHub</a>
        </li>
      </ul>
    </div>
  </nav>
</header>


    <main class="container" role="main">
      <div class="row justify-content-center">
        <div class="col col-xl-8">
          <h1 class="no_toc" id="backtracking">Backtracking</h1>

<h2 class="no_toc" id="contenidos">Contenidos</h2>

<ol id="markdown-toc">
  <li><a href="#ejercicio-resuelto" id="markdown-toc-ejercicio-resuelto">Ejercicio resuelto</a>    <ol>
      <li><a href="#solución" id="markdown-toc-solución">Solución</a></li>
    </ol>
  </li>
  <li><a href="#ejercicios-propuestos" id="markdown-toc-ejercicios-propuestos">Ejercicios propuestos</a></li>
  <li><a href="#bibliografía-y-referencias" id="markdown-toc-bibliografía-y-referencias">Bibliografía y referencias</a></li>
</ol>

<h2 id="ejercicio-resuelto">Ejercicio resuelto</h2>

<p>Se tiene una lista de materias que deben ser cursadas en el mismo cuatrimestre, cada materia está representada con una lista de cursos/horarios posibles a cursar (solo debe elegirse uno de todos ellos). Cada materia puede tener varios cursos.</p>

<p>Implementar el pseudocódigo de un algoritmo de backtracking que devuelva un listado con todas las combinaciones posibles que permitan asistir a un curso de cada materia sin que se solapen los horarios.
Considerar que existe una función <code class="language-plaintext highlighter-rouge">son_compatibles(curso_1, curso_2)</code> que dados dos cursos devuelve un valor booleano que indica si se pueden cursar al mismo tiempo.</p>

<h3 id="solución">Solución</h3>

<p>Lo primero que hay que tratar de entender, es que es necesario tratar de ir generando las combinaciones hasta encontrar alguna válida. Por fuerza bruta, sería obtener primero todas las combinaciones de materias (un curso por cada materia) y luego ver cuáles son incompatibles para filtrar.
Suponiendo que todas las materias tenga <em>k</em> cursos, y que tenemos <em>n</em> materias, tendríamos un orden de \(\mathcal{O}(k^n)\) para generar cada combinacion (pues hay \(k^n\) combinaciones, supondremos que generar cada una costará a lo sumo \(\mathcal{O}(n)\), despreciable al lado del otro término aunque <em>k</em> fuere constante o muy pequeño).
Luego, sería necesario filtrar las opciones incorrectas, pero esto lo vamos a obviar porque la idea es plantear que esto no sea necesario. La idea va a ser ir generando todas esas combinaciones posibles, pero en cuanto detectemos que una opcion no es válida, simplemente descartarla.</p>

<p>Por ejemplo, si ya sabemos que el primer curso de Algoritmos y Programación II no es compatible con el primer curso de Álgebra II, por qué ver todas las combinaciones que incluyan estos dos cursos? Ya podemos descartarlas al encontrar esta colisión. En el peor de los casos, todos los cursos son compatibles entre sí sin colisión y mantendremos el orden (aunque siendo realistas, esto no sucede ni cuando las materias son de curso único).</p>

<p>Por lo tanto, allí estará la poda: cuando detectemos que un curso es incompatible con el resto, descartamos la opción. Simplemente con analizar si la ultima materia agregada en cada paso es compatible con las anteriores, será suficiente (luego, no es necesario validar la primera con la segunda, la primera con la tercera, etc… porque eso ya debería haberse hecho). De esta forma reducimos el costo de esa poda de \(\mathcal{O}(n^2)\) a \(\mathcal{O}(n)\).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">horarios_posibles</span><span class="p">(</span><span class="n">materias</span><span class="p">,</span> <span class="n">solucion_parcial</span><span class="p">):</span>
    <span class="c1"># Si no nos quedan materias por ver
</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">materias</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">solucion_posible</span><span class="p">(</span><span class="n">solucion_parcial</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">solucion_parcial</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># No es solucion total, pero es solucion parcial?
</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">solucion_posible</span><span class="p">(</span><span class="n">solucion_parcial</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># Caso general, por ahora la solucion parcial es aceptada:
</span>    <span class="n">materia_actual</span> <span class="o">=</span> <span class="n">materias</span><span class="p">.</span><span class="n">ver_primero</span><span class="p">()</span>
    <span class="n">materias</span><span class="p">.</span><span class="n">borrar_primero</span><span class="p">()</span>

    <span class="n">soluciones</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">curso</span> <span class="ow">in</span> <span class="n">materia_actual</span><span class="p">:</span>
        <span class="c1"># Si devuelve una lista con soluciones parciales, se agregaran todas a esta lista. Si devuelve lista vacia, no hara nada
</span>        <span class="n">soluciones</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">horarios_posibles</span><span class="p">(</span><span class="n">materias_restantes</span><span class="p">,</span> <span class="n">solucion_parcial</span> <span class="o">+</span> <span class="p">[</span><span class="n">curso</span><span class="p">]))</span>

    <span class="c1"># Si interesa volver a poner la materia que sacamos:
</span>    <span class="n">materias</span><span class="p">.</span><span class="n">guardar_primero</span><span class="p">(</span><span class="n">materia_actual</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">soluciones</span>

<span class="k">def</span> <span class="nf">solucion_posible</span><span class="p">(</span><span class="n">horarios</span><span class="p">):</span>
    <span class="n">ultimo</span> <span class="o">=</span> <span class="n">horarios</span><span class="p">.</span><span class="n">ver_ultimo</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">curso</span> <span class="ow">in</span> <span class="n">horarios</span> <span class="p">(</span><span class="n">salvo</span> <span class="n">el</span> <span class="n">ultimo</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">son_compatibles</span><span class="p">(</span><span class="n">curso</span><span class="p">,</span> <span class="n">ultimo</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</code></pre></div></div>

<h2 id="ejercicios-propuestos">Ejercicios propuestos</h2>

<ol>
  <li>
    <p>Diseñar un algoritmo de backtracking que resuelva el siguiente problema: dado una pieza de caballo de ajedrez (<em>knight</em>, o caballero) dentro de un tablero, determinar los movimientos a hacer para que el caballo logre pasar por todos los casilleros, una única vez.</p>

    <p>Recordar que el caballo se mueve en forma de L (dos casilleros en una dirección, y un casillero en dirección perpendicular).</p>
  </li>
  <li>
    <p>Escribir en pseudocódigo un algoritmo de tipo Backtracking que reciba una cantidad de dados <em>n</em> y una suma <em>s</em>. La función debe imprimir todas las tiradas posibles de n dados cuya suma es s. Por ejemplo, con <code class="language-plaintext highlighter-rouge">n = 2</code> y <code class="language-plaintext highlighter-rouge">s = 7</code>, debe imprimir <code class="language-plaintext highlighter-rouge">[1, 6] [2, 5] [3, 4] [4, 3] [5, 2] [6, 1]</code>.</p>

    <p>¿De qué orden es el algoritmo en tiempo y memoria?</p>
  </li>
  <li>
    <p>Escribir una función en pseudocódigo que, utilizando backtracking, dada una lista de enteros positivos <em>L</em> y un entero <em>n</em> devuelva todos los subconjuntos de <em>L</em> que suman exactamente <em>n</em>. ¿Cómo cambia el comportamiento del algoritmo frente a una solución por fuerza bruta? Explicar con al menos dos ejemplos de <em>L</em> y <em>n</em>.
<a href="/algo2/material/guias/soluciones/subset_sum.py">(Solución)</a></p>
  </li>
  <li>
    <p>¡Ejercicio difícil! Realizar el ejercicio anterior, si además se agregar como restricción que no se puede utilizar más de una vez un mismo elemento de la lista L, pero se quieren maximizar la cantidad de conjuntos obtenidos.</p>
  </li>
</ol>

<h2 id="bibliografía-y-referencias">Bibliografía y referencias</h2>

<ul>
  <li>Weiss, Mark Allen: “Data Structures and Algorithms” (tercera edición), Pearson, 1999. Cap. 10.5: <em>Backtracking algorithms</em>.</li>
  <li>Kruse, Robert Leroy;  Tondon, Clovis L.;  Leung, Bruce P: “Data structures and program design in C”, Prentice-Hall, 1997. Cap 5.3: <em>Backtracking: Postponing the Work</em>.</li>
  <li>Guerequeta, Rosa; Vallecillo, Antonio: “Técnicas de Diseño de Algoritmos” (segunda edición), Servicio de Publicaciones de la Universidad de Málaga, 1998. Cap 6: <em>Vuelta atrás</em>.</li>
</ul>


        </div>
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.slim.min.js"
        integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8=" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"
        integrity="sha384-6khuMg9gaYr5AxOqhkVIODVIvm9ynTT5J4V1cfthmT+emCG6yVmEZsRHdxlotUnm" crossorigin="anonymous"></script>

  </body>

</html>
